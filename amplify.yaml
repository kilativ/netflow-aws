version: 1
frontend:
  phases:
    preBuild:
      commands:
        - npm ci
    build:
      commands:
        - npm run build
        - echo "GOOGLE_CLIENT_ID=$GOOGLE_CLIENT_ID" >> build/.env
        - echo "GOOGLE_CLIENT_SECRET=$GOOGLE_CLIENT_SECRET" >> build/.env
        - echo "PLAID_CLIENT_ID=$PLAID_CLIENT_ID" >> build/.env
        - echo "PLAID_SECRET=$PLAID_SECRET" >> build/.env
        - echo "PLAID_ENV=$PLAID_ENV" >> build/.env
        - echo "PLAID_PRODUCTS=$PLAID_PRODUCTS" >> build/.env
        - echo "PLAID_COUNTRY_CODES=$PLAID_COUNTRY_CODES" >> build/.env
        - echo "ACCT_DYNAMODB_TABLE=$ACCT_DYNAMODB_TABLE" >> build/.env
        - echo "TAXN_DYNAMODB_TABLE=$TAXN_DYNAMODB_TABLE" >> build/.env
        - echo "BALANCE_DYNAMODB_TABLE=$BALANCE_DYNAMODB_TABLE" >> build/.env        
  artifacts:
    baseDirectory: /build/
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
